name: pod-metrics
code: pod
description: 'pod metrics collectors promql'
cronExpression: '@every 2h'
promQls:
  - name: 'cpu request'
    code: 'CPURequest'
    query: 'sum(kube_pod_container_resource_requests_cpu_cores) by (pod)'
  - name: 'cpu limit'
    code: 'CPULimit'
    query: 'sum(kube_pod_container_resource_limits_cpu_cores) by (pod)'
  - name: 'Memory Request'
    code: 'MemoryRequest'
    query: 'sum(kube_pod_container_resource_requests_memory_bytes/1024/1024/1024) by (pod)'
  - name: 'memory limit'
    code: 'MemoryLimit'
    query: 'sum(kube_pod_container_resource_limits_memory_bytes/1024/1024/1024) by (pod)'
  - name: 'cpu usage max'
    code: 'CPUUsageMax'
    query: 'sum(max_over_time(irate(container_cpu_usage_seconds_total{namespace!=""}[4m] ) [1h:4m])) by (pod)'
  - name: 'cpu usage average'
    code: 'CPUUsageAvg'
    query: 'sum(avg_over_time(irate(container_cpu_usage_seconds_total{namespace!=""}[4m] ) [1h:4m])) by (pod)'
  - name: 'cpu usage min'
    code: 'CPUUsageMin'
    query: 'sum(min_over_time(irate(container_cpu_usage_seconds_total{namespace!=""}[4m] ) [1h:4m])) by (pod)'
  - name: 'memory usage max'
    code: 'MemoryUsageMax'
    query: 'sum(max_over_time(container_memory_working_set_bytes{namespace!="",container!="",image!=""}[1h])/1024/1024/1024) by (pod)'
  - name: 'memory usage average'
    code: 'MemoryUsageAvg'
    query: 'sum(avg_over_time(container_memory_working_set_bytes{namespace!="",container!="",image!=""}[1h])/1024/1024/1024) by (pod)'
  - name: 'memory usage min'
    code: 'MemoryUsageMin'
    query: 'sum(min_over_time(container_memory_working_set_bytes{namespace!="",container!="",image!=""}[1h])/1024/1024/1024) by (pod)'